"use strict";(self["webpackChunkvideoproject"]=self["webpackChunkvideoproject"]||[]).push([[443],{6431:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var r=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"header"},[t("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.$route.path,router:"",mode:"horizontal","active-text-color":"#ffffff","text-color":"#666666"}},[t("el-menu-item",{attrs:{index:"/"}},[t("img",{attrs:{src:e.logoImg,alt:""}})]),t("el-menu-item",{staticStyle:{float:"right"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("联系我们")]),t("el-menu-item",{staticStyle:{float:"right"},attrs:{index:"3"}},[t("a",{attrs:{href:""}},[e._v("新手指南")])])],1)],1),t("div",{staticClass:"content"},[t("el-row",{staticClass:"content_bg"},[t("el-col",{staticClass:"left",attrs:{span:16}}),t("el-col",{staticClass:"right",attrs:{span:8}})],1),t("el-row",{staticClass:"content_body"},[t("el-col",{staticClass:"left",attrs:{span:12}},[t("div",{staticClass:"content_img"},[t("img",{attrs:{id:"img",src:a(4798),alt:""}})])]),t("el-col",{staticClass:"right",attrs:{span:12}},[e.hasBindPhone?t("div",{staticClass:"tabs"},[t("h3",{staticStyle:{"padding-bottom":"17px"}},[e._v("请绑定手机号")]),t("el-form",{ref:"bindPhoneRuleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.bindPhoneRules}},[t("el-form-item",{attrs:{prop:"phone"}},[t("el-input",{attrs:{placeholder:"请输入手机号码",autocomplete:"off"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),t("el-form-item",{attrs:{prop:"verificationCode"}},[t("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:e.ruleForm.verificationCode,callback:function(t){e.$set(e.ruleForm,"verificationCode",t)},expression:"ruleForm.verificationCode"}},[t("el-button",{style:{color:e.isDisabled?"#999999":"#2489F3"},attrs:{slot:"append",disabled:e.isDisabled,type:"text"},on:{click:function(t){return e.handlerSend("mobilelogin")}},slot:"append"},[e._v(" "+e._s(e.verificationCodeText))])],1)],1),t("el-form-item",[t("el-button",{staticClass:"submit_btn",class:{disabled_opacity:e.phoneError||e.codeError},attrs:{disabled:e.phoneError||e.codeError,round:""},on:{click:function(t){return e.handleBindPhone("bindPhoneRuleForm")}}},[e._v("提交")])],1)],1),t("p",{staticClass:"privacy_agreement"},[e._v("绑定后即可使用微信扫码登录，更便捷")])],1):t("div",{staticClass:"tabs"},[t("h3",[e._v("注册/登录")]),t("p",{staticClass:"description"},[e._v("未注册时，首次登录系统将自动为您注册")]),t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"微信扫码",name:"first"}},[t("div",{staticClass:"qrcode"},[t("span",{staticClass:"top"}),t("span",{staticClass:"bottom"}),t("span",{staticClass:"left"}),t("span",{staticClass:"right"}),t("img",{attrs:{src:e.qrImg,alt:""}}),e.isRefresh?t("div",{attrs:{id:"refreshQrcode"},on:{click:e.handleRefresh}},[t("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},[t("div",[t("i",{staticClass:"el-icon-refresh-right"}),t("span",[e._v("点击刷新")])])])]):e._e()]),t("p",{staticClass:"privacy_agreement"},[e._v("登录平台即代表同意"),t("a",{attrs:{href:""}},[e._v("服务条款")]),e._v("及"),t("a",{attrs:{href:""}},[e._v("用户隐私协议")])])]),t("el-tab-pane",{attrs:{label:"验证码",name:"second"}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[t("el-form-item",{attrs:{prop:"phone"}},[t("el-input",{attrs:{placeholder:"请输入手机号码",autocomplete:"off"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),t("el-form-item",{attrs:{prop:"verificationCode"}},[t("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:e.ruleForm.verificationCode,callback:function(t){e.$set(e.ruleForm,"verificationCode",t)},expression:"ruleForm.verificationCode"}},[t("el-button",{style:{color:e.isDisabled?"#999999":"#2489F3"},attrs:{slot:"append",disabled:e.isDisabled,type:"text"},on:{click:function(t){return e.handlerSend("mobilelogin")}},slot:"append"},[e._v(" "+e._s(e.verificationCodeText)+" ")])],1)],1),t("el-form-item",[t("el-button",{staticClass:"submit_btn",class:{disabled_opacity:e.phoneError||e.codeError},attrs:{disabled:e.phoneError||e.codeError,round:""},on:{click:function(t){return e.handleSubmitForm("ruleForm")}}},[e._v("提交")])],1)],1),t("p",{staticClass:"privacy_agreement"},[e._v("登录平台即代表同意"),t("a",{attrs:{href:""}},[e._v("服务条款")]),e._v("及"),t("a",{attrs:{href:""}},[e._v("用户隐私协议")])])],1)],1)],1)])],1)],1),t("el-dialog",{attrs:{title:"微信咨询",visible:e.dialogVisible,center:"",width:"320px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"contact_us_box"},[t("span"),t("span"),t("span"),t("span"),t("img",{attrs:{src:a(6501),alt:""}})]),t("div",{staticClass:"contact_us_foot"},[t("p",[t("i",{staticClass:"iconfont icon-phone-call"}),t("span",[e._v("电话：")]),e._v("0755-84861340")]),t("p",[t("i",{staticClass:"iconfont icon-mail"}),t("span",[e._v("邮箱：")]),e._v("support@amztracker.com")])])])],1)},s=[],i=(a(7658),a(629)),o=a(8884),l=a(9981),n={name:"login",data(){const e=(e,t,a)=>{const r=/^(0|86|17951)?(13[0-9]|15[012356789]|166|17[3678]|18[0-9]|14[57])[0-9]{8}$/;r.test(t)?(this.isDisabled=!1,this.phoneError=!1,a()):(a(new Error("手机号码格式错误，请输入正确的手机号码！")),this.isDisabled=!0,this.phoneError=!0)},t=(e,t,a)=>{const r=/^[0-9]{4}$/;r.test(t)?(this.codeError=!1,a()):(this.codeError=!0,a(new Error("验证码格式错误，请输入正确的验证码！")))};return{dialogVisible:!1,phoneError:!0,codeError:!0,isSubmitDisabled:!0,isRefresh:!1,qrImg:"",activeName:"first",checkQrCode:"",hasBindPhone:!1,isDisabled:!0,isBindPhoneDisabled:!1,verificationCodeText:"获取验证码",logoImg:a(4427),disabledText:{color:"#999999"},ruleForm:{phone:"",verificationCode:""},rules:{phone:[{required:!0,message:"请输入手机号码！",trigger:"blur"},{validator:e,trigger:["blur","change"]}],verificationCode:[{required:!0,message:"请输入验证码",trigger:"blur"},{validator:t,trigger:["blur","change"]}]},bindPhoneRules:{phone:[{required:!0,message:"请输入手机号码！",trigger:"blur"},{validator:e,trigger:["blur","change"]}],verificationCode:[{required:!0,message:"请输入验证码",trigger:"blur"},{validator:t,trigger:["blur","change"]}]},wechatToken:"",fromPath:localStorage.getItem("loginFromPath")}},created(){},mounted(){this.handlerGetQrcode(),this.verifyToken(),this.logoImg=localStorage.getItem("logo")},methods:{...(0,i.OI)("login",["setUserInfo","setToken","setAvatar","setExpiretime"]),handlerGetQrcode(){(0,o.fN)().then((e=>{1===e.code&&(this.qrImg=e.data.qrcode_url,this.wechatToken=e.data.wechat_token,this.isRefresh=!1,this.handleCheckQr())})).catch((e=>{console.log(e),this.$message.error(e.msg)}))},handleCheckQr(){var e=0;let t=this,a=new FormData;a.append("wechat_token",t.wechatToken),t.checkQrCode=setInterval((()=>{(0,o.Zm)(a).then((a=>{0===a.code&&(t.isRefresh=!0,clearInterval(t.checkQrCode)),1===a.code&&0===a.data.status?(e++,e>60&&(t.isRefresh=!0,clearInterval(t.checkQrCode))):1===a.code&&1===a.data.status?(t.hasBindPhone=!0,clearInterval(t.checkQrCode)):1===a.code&&2===a.data.status&&(clearInterval(t.checkQrCode),localStorage.setItem("userInfo",JSON.stringify(a.data.userinfo)),localStorage.setItem("token",a.data.userinfo.token),localStorage.setItem("avatar",a.data.userinfo.avatar),localStorage.setItem("expiretime",a.data.userinfo.expiretime),this.setExpiretime(a.data.userinfo.expiretime),this.setUserInfo(JSON.stringify(a.data.userinfo)),this.setToken(a.data.userinfo.token),this.setAvatar(a.data.userinfo.avatar),this.$router.push(this.fromPath))})).catch((e=>{this.$message.error(e.msg)}))}),3e3)},handleClick(e){0==e.index?this.handleCheckQr():clearInterval(this.checkQrCode)},handlerSend(e){(0,o.Gy)({mobile:this.ruleForm.phone,event:e}).then((e=>{})).catch((e=>{this.$message.error(e.msg)}));let t=30,a=this,r=setInterval((function(){t--,t>0?(a.verificationCodeText=t+"s后重新获取",a.isDisabled=!0):(t=30,a.verificationCodeText="获取验证码",a.isDisabled=!1,clearInterval(r))}),1e3)},handleSubmitForm(e){this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),!1;(0,o.cX)({mobile:this.ruleForm.phone,captcha:this.ruleForm.verificationCode}).then((e=>{1===e.code&&("register"==e.data.type&&this.$message.success(e.msg),clearInterval(this.checkQrCode),localStorage.setItem("userInfo",JSON.stringify(e.data.userinfo)),localStorage.setItem("token",e.data.userinfo.token),localStorage.setItem("avatar",e.data.userinfo.avatar),localStorage.setItem("expiretime",e.data.userinfo.expiretime),this.setExpiretime(e.data.userinfo.expiretime),this.setUserInfo(JSON.stringify(e.data.userinfo)),this.setToken(e.data.userinfo.token),this.setAvatar(e.data.userinfo.avatar),this.$router.push(this.fromPath))})).catch((e=>{console.log(e)}))}))},handleBindPhone(e){this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),!1;(0,o.eF)({mobile:this.ruleForm.phone,captcha:this.ruleForm.verificationCode,wechat_token:this.wechatToken}).then((e=>{1===e.code?(clearInterval(this.checkQrCode),localStorage.setItem("userInfo",JSON.stringify(e.data.userinfo)),localStorage.setItem("token",e.data.userinfo.token),localStorage.setItem("avatar",e.data.userinfo.avatar),localStorage.setItem("expiretime",e.data.userinfo.expiretime),this.setExpiretime(e.data.userinfo.expiretime),this.setUserInfo(JSON.stringify(e.data.userinfo)),this.setToken(e.data.userinfo.token),this.setAvatar(e.data.userinfo.avatar),this.$router.push(this.fromPath)):0===e.code&&0===e.data.status&&(this.hasBindPhone=!1)})).catch((e=>{console.log(e)}))}))},handleRefresh(){this.handlerGetQrcode()},startCron(){var e=0;let t=this;var a=setInterval((function(){e++,e>60&&(t.isRefresh=!0,clearInterval(a))}),3e3)},verifyToken(){let e=l.Z.state.token;e&&this.$router.push({path:"/"})}}},c=n,d=a(1001),h=(0,d.Z)(c,r,s,!1,null,"06bce428",null),u=h.exports},4798:function(e,t,a){e.exports=a.p+"static/img/login_banner.4bfb8ad3.png"}}]);